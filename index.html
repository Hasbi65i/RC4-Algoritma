<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Visualisasi Algoritma RC4</title>

<style>
body{
  font-family:Arial,sans-serif;
  background:#eaf6f4;
  display:flex;
  justify-content:center;
}
.container{
  width:420px;
  background:white;
  padding:20px;
  margin-top:40px;
  border-radius:12px;
  box-shadow:0 4px 10px rgba(0,0,0,.1);
}
h2{
  text-align:center;
  color:#2b7a78;
  margin-bottom:5px;
}
.identity{
  text-align:center;
  font-size:14px;
  margin-bottom:15px;
}
label{
  font-weight:bold;
  display:block;
  margin-top:12px;
}
input{
  width:100%;
  padding:8px;
  margin-top:5px;
  border:1px solid #2b7a78;
  border-radius:6px;
}
button{
  width:100%;
  margin-top:15px;
  padding:10px;
  background:#2b7a78;
  color:white;
  border:none;
  border-radius:6px;
  font-weight:bold;
  cursor:pointer;
}
pre{
  background:#f4f4f4;
  padding:10px;
  margin-top:12px;
  border-radius:6px;
  font-size:12px;
  max-height:220px;
  overflow-y:auto;
}
</style>
</head>

<body>

<div class="container">
  <h2>Visualisasi Algoritma RC4</h2>

  <div class="identity">
    <b>Nama:</b> Hasbi Mustafa<br>
    <b>NPM:</b> 23120050
  </div>

  <label>Panjang Array S</label>
  <input type="text" id="n" value="8">

  <label>Array K (pisahkan koma)</label>
  <input type="text" id="key" value="2,1,3,0">

  <label>Plaintext</label>
  <input type="text" id="plaintext" value="HELLO">

  <button onclick="jalankanRC4()">Jalankan RC4</button>

  <pre id="ksa"></pre>
  <pre id="prga"></pre>
  <pre id="output"></pre>
</div>

<script>
function hurufKeAngka(teks){
  return teks.toUpperCase().split('').map(c=>c.charCodeAt(0)-65);
}

function jalankanRC4(){
  const n=parseInt(document.getElementById("n").value);
  let S=[...Array(n).keys()];
  let K=document.getElementById("key").value.split(',').map(Number);
  let plaintext=hurufKeAngka(document.getElementById("plaintext").value);

  let logKSA="=== KSA (Key Scheduling Algorithm) ===\n";
  let j=0;

  for(let i=0;i<n;i++){
    j=(j+S[i]+K[i%K.length])%n;
    logKSA+=`i=${i}, j=${j} â†’ swap(S[${i}], S[${j}])\n`;
    [S[i],S[j]]=[S[j],S[i]];
    logKSA+=`S = [${S.join(", ")}]\n\n`;
  }

  let logPRGA="=== PRGA ===\n";
  let i=0; 
  j=0;
  let keystream=[];

  for(let t=0;t<plaintext.length;t++){
    i=(i+1)%n;
    j=(j+S[i])%n;
    [S[i],S[j]]=[S[j],S[i]];
    let k=S[(S[i]+S[j])%n];
    keystream.push(k);

    logPRGA+=`Iterasi ${t+1}: i=${i}, j=${j}, K=${k}\n`;
  }

  let cipher=plaintext.map((p,idx)=>p^keystream[idx]);

  document.getElementById("ksa").innerText=logKSA;
  document.getElementById("prga").innerText=logPRGA;
  document.getElementById("output").innerText=
    "Keystream  : "+keystream.join(", ")+
    "\nCiphertext : "+cipher.join(", ");
}
</script>

</body>
</html>
